Traceback (most recent call last):
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
prepare_data(sc5, 200, 1000, 1000, 200)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[6], line 1[0m
[0;32m----> 1[0m [43mprepare_data[49m[43m([49m[43msc5[49m[43m,[49m[43m [49m[38;5;241;43m200[39;49m[43m,[49m[43m [49m[38;5;241;43m1000[39;49m[43m,[49m[43m [49m[38;5;241;43m1000[39;49m[43m,[49m[43m [49m[38;5;241;43m200[39;49m[43m)[49m

File [0;32m/tmp/ipykernel_2655/3337232756.py:3[0m, in [0;36mprepare_data[0;34m(sc, training_time, test_time, predict_time, mask_time)[0m
[1;32m      1[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mprepare_data[39m(sc, training_time, test_time, predict_time, mask_time[38;5;241m=[39m[38;5;241m11[39m):
[1;32m      2[0m     cat [38;5;241m=[39m open_catalog([38;5;124m"[39m[38;5;124mhttps://raw.githubusercontent.com/pangeo-data/pangeo-datastore/master/intake-catalogs/ocean/CESM_POP.yaml[39m[38;5;124m"[39m)
[0;32m----> 3[0m     ds  [38;5;241m=[39m [43mcat[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mCESM_POP_hires_control[39;49m[38;5;124;43m"[39;49m[43m][49m[38;5;241;43m.[39;49m[43mto_dask[49m[43m([49m[43m)[49m
[1;32m      4[0m     ds [38;5;241m=[39m ds[38;5;241m.[39mrename({[38;5;124m'[39m[38;5;124mU1_1[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mU[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mV1_1[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mV[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mTAUX_2[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mTAUX[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mTAUY_2[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mTAUY[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mSSH_2[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mSSH[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mULONG[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mXU[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mULAT[39m[38;5;124m'[39m:[38;5;124m'[39m[38;5;124mYU[39m[38;5;124m'[39m})
[1;32m      5[0m     ds [38;5;241m=[39m add_grid(ds)

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/intake_xarray/base.py:8[0m, in [0;36mIntakeXarraySourceAdapter.to_dask[0;34m(self)[0m
[1;32m      6[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mto_dask[39m([38;5;28mself[39m):
[1;32m      7[0m     [38;5;28;01mif[39;00m [38;5;124m"[39m[38;5;124mchunks[39m[38;5;124m"[39m [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mreader[38;5;241m.[39mkwargs:
[0;32m----> 8[0m         [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreader[49m[43m([49m[43mchunks[49m[38;5;241;43m=[39;49m[43m{[49m[43m}[49m[43m)[49m[38;5;241;43m.[39;49m[43mread[49m[43m([49m[43m)[49m
[1;32m      9[0m     [38;5;28;01melse[39;00m:
[1;32m     10[0m         [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mreader[38;5;241m.[39mread()

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/intake/readers/readers.py:121[0m, in [0;36mBaseReader.read[0;34m(self, *args, **kwargs)[0m
[1;32m    119[0m kw[38;5;241m.[39mupdate(kwargs)
[1;32m    120[0m args [38;5;241m=[39m kw[38;5;241m.[39mpop([38;5;124m"[39m[38;5;124margs[39m[38;5;124m"[39m, ()) [38;5;129;01mor[39;00m args
[0;32m--> 121[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_read[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkw[49m[43m)[49m

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/intake/readers/readers.py:1327[0m, in [0;36mXArrayDatasetReader._read[0;34m(self, data, open_local, **kw)[0m
[1;32m   1325[0m         f [38;5;241m=[39m fsspec[38;5;241m.[39mopen(data[38;5;241m.[39murl, [38;5;241m*[39m[38;5;241m*[39m(data[38;5;241m.[39mstorage_options [38;5;129;01mor[39;00m {}))[38;5;241m.[39mopen()
[1;32m   1326[0m         [38;5;28;01mreturn[39;00m open_dataset(f, [38;5;241m*[39m[38;5;241m*[39mkw)
[0;32m-> 1327[0m [38;5;28;01mreturn[39;00m [43mopen_dataset[49m[43m([49m[43mdata[49m[38;5;241;43m.[39;49m[43murl[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkw[49m[43m)[49m

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/xarray/backends/api.py:687[0m, in [0;36mopen_dataset[0;34m(filename_or_obj, engine, chunks, cache, decode_cf, mask_and_scale, decode_times, decode_timedelta, use_cftime, concat_characters, decode_coords, drop_variables, inline_array, chunked_array_type, from_array_kwargs, backend_kwargs, **kwargs)[0m
[1;32m    675[0m decoders [38;5;241m=[39m _resolve_decoders_kwargs(
[1;32m    676[0m     decode_cf,
[1;32m    677[0m     open_backend_dataset_parameters[38;5;241m=[39mbackend[38;5;241m.[39mopen_dataset_parameters,
[0;32m   (...)[0m
[1;32m    683[0m     decode_coords[38;5;241m=[39mdecode_coords,
[1;32m    684[0m )
[1;32m    686[0m overwrite_encoded_chunks [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m"[39m[38;5;124moverwrite_encoded_chunks[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m)
[0;32m--> 687[0m backend_ds [38;5;241m=[39m [43mbackend[49m[38;5;241;43m.[39;49m[43mopen_dataset[49m[43m([49m
[1;32m    688[0m [43m    [49m[43mfilename_or_obj[49m[43m,[49m
[1;32m    689[0m [43m    [49m[43mdrop_variables[49m[38;5;241;43m=[39;49m[43mdrop_variables[49m[43m,[49m
[1;32m    690[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mdecoders[49m[43m,[49m
[1;32m    691[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    692[0m [43m[49m[43m)[49m
[1;32m    693[0m ds [38;5;241m=[39m _dataset_from_backend_dataset(
[1;32m    694[0m     backend_ds,
[1;32m    695[0m     filename_or_obj,
[0;32m   (...)[0m
[1;32m    705[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs,
[1;32m    706[0m )
[1;32m    707[0m [38;5;28;01mreturn[39;00m ds

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/xarray/backends/zarr.py:1578[0m, in [0;36mZarrBackendEntrypoint.open_dataset[0;34m(self, filename_or_obj, mask_and_scale, decode_times, concat_characters, decode_coords, drop_variables, use_cftime, decode_timedelta, group, mode, synchronizer, consolidated, chunk_store, storage_options, zarr_version, zarr_format, store, engine, use_zarr_fill_value_as_mask, cache_members)[0m
[1;32m   1576[0m filename_or_obj [38;5;241m=[39m _normalize_path(filename_or_obj)
[1;32m   1577[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m store:
[0;32m-> 1578[0m     store [38;5;241m=[39m [43mZarrStore[49m[38;5;241;43m.[39;49m[43mopen_group[49m[43m([49m
[1;32m   1579[0m [43m        [49m[43mfilename_or_obj[49m[43m,[49m
[1;32m   1580[0m [43m        [49m[43mgroup[49m[38;5;241;43m=[39;49m[43mgroup[49m[43m,[49m
[1;32m   1581[0m [43m        [49m[43mmode[49m[38;5;241;43m=[39;49m[43mmode[49m[43m,[49m
[1;32m   1582[0m [43m        [49m[43msynchronizer[49m[38;5;241;43m=[39;49m[43msynchronizer[49m[43m,[49m
[1;32m   1583[0m [43m        [49m[43mconsolidated[49m[38;5;241;43m=[39;49m[43mconsolidated[49m[43m,[49m
[1;32m   1584[0m [43m        [49m[43mconsolidate_on_close[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m   1585[0m [43m        [49m[43mchunk_store[49m[38;5;241;43m=[39;49m[43mchunk_store[49m[43m,[49m
[1;32m   1586[0m [43m        [49m[43mstorage_options[49m[38;5;241;43m=[39;49m[43mstorage_options[49m[43m,[49m
[1;32m   1587[0m [43m        [49m[43mzarr_version[49m[38;5;241;43m=[39;49m[43mzarr_version[49m[43m,[49m
[1;32m   1588[0m [43m        [49m[43muse_zarr_fill_value_as_mask[49m[38;5;241;43m=[39;49m[38;5;28;43;01mNone[39;49;00m[43m,[49m
[1;32m   1589[0m [43m        [49m[43mzarr_format[49m[38;5;241;43m=[39;49m[43mzarr_format[49m[43m,[49m
[1;32m   1590[0m [43m        [49m[43mcache_members[49m[38;5;241;43m=[39;49m[43mcache_members[49m[43m,[49m
[1;32m   1591[0m [43m    [49m[43m)[49m
[1;32m   1593[0m store_entrypoint [38;5;241m=[39m StoreBackendEntrypoint()
[1;32m   1594[0m [38;5;28;01mwith[39;00m close_on_error(store):

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/xarray/backends/zarr.py:664[0m, in [0;36mZarrStore.open_group[0;34m(cls, store, mode, synchronizer, group, consolidated, consolidate_on_close, chunk_store, storage_options, append_dim, write_region, safe_chunks, align_chunks, zarr_version, zarr_format, use_zarr_fill_value_as_mask, write_empty, cache_members)[0m
[1;32m    638[0m [38;5;129m@classmethod[39m
[1;32m    639[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mopen_group[39m(
[1;32m    640[0m     [38;5;28mcls[39m,
[0;32m   (...)[0m
[1;32m    657[0m     cache_members: [38;5;28mbool[39m [38;5;241m=[39m [38;5;28;01mTrue[39;00m,
[1;32m    658[0m ):
[1;32m    659[0m     (
[1;32m    660[0m         zarr_group,
[1;32m    661[0m         consolidate_on_close,
[1;32m    662[0m         close_store_on_close,
[1;32m    663[0m         use_zarr_fill_value_as_mask,
[0;32m--> 664[0m     ) [38;5;241m=[39m [43m_get_open_params[49m[43m([49m
[1;32m    665[0m [43m        [49m[43mstore[49m[38;5;241;43m=[39;49m[43mstore[49m[43m,[49m
[1;32m    666[0m [43m        [49m[43mmode[49m[38;5;241;43m=[39;49m[43mmode[49m[43m,[49m
[1;32m    667[0m [43m        [49m[43msynchronizer[49m[38;5;241;43m=[39;49m[43msynchronizer[49m[43m,[49m
[1;32m    668[0m [43m        [49m[43mgroup[49m[38;5;241;43m=[39;49m[43mgroup[49m[43m,[49m
[1;32m    669[0m [43m        [49m[43mconsolidated[49m[38;5;241;43m=[39;49m[43mconsolidated[49m[43m,[49m
[1;32m    670[0m [43m        [49m[43mconsolidate_on_close[49m[38;5;241;43m=[39;49m[43mconsolidate_on_close[49m[43m,[49m
[1;32m    671[0m [43m        [49m[43mchunk_store[49m[38;5;241;43m=[39;49m[43mchunk_store[49m[43m,[49m
[1;32m    672[0m [43m        [49m[43mstorage_options[49m[38;5;241;43m=[39;49m[43mstorage_options[49m[43m,[49m
[1;32m    673[0m [43m        [49m[43mzarr_version[49m[38;5;241;43m=[39;49m[43mzarr_version[49m[43m,[49m
[1;32m    674[0m [43m        [49m[43muse_zarr_fill_value_as_mask[49m[38;5;241;43m=[39;49m[43muse_zarr_fill_value_as_mask[49m[43m,[49m
[1;32m    675[0m [43m        [49m[43mzarr_format[49m[38;5;241;43m=[39;49m[43mzarr_format[49m[43m,[49m
[1;32m    676[0m [43m    [49m[43m)[49m
[1;32m    678[0m     [38;5;28;01mreturn[39;00m [38;5;28mcls[39m(
[1;32m    679[0m         zarr_group,
[1;32m    680[0m         mode,
[0;32m   (...)[0m
[1;32m    689[0m         cache_members[38;5;241m=[39mcache_members,
[1;32m    690[0m     )

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/xarray/backends/zarr.py:1777[0m, in [0;36m_get_open_params[0;34m(store, mode, synchronizer, group, consolidated, consolidate_on_close, chunk_store, storage_options, zarr_version, use_zarr_fill_value_as_mask, zarr_format)[0m
[1;32m   1773[0m group [38;5;241m=[39m open_kwargs[38;5;241m.[39mpop([38;5;124m"[39m[38;5;124mpath[39m[38;5;124m"[39m)
[1;32m   1775[0m [38;5;28;01mif[39;00m consolidated:
[1;32m   1776[0m     [38;5;66;03m# TODO: an option to pass the metadata_key keyword[39;00m
[0;32m-> 1777[0m     zarr_root_group [38;5;241m=[39m [43mzarr[49m[38;5;241;43m.[39;49m[43mopen_consolidated[49m[43m([49m[43mstore[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mopen_kwargs[49m[43m)[49m
[1;32m   1778[0m [38;5;28;01melif[39;00m consolidated [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1779[0m     [38;5;66;03m# same but with more error handling in case no consolidated metadata found[39;00m
[1;32m   1780[0m     [38;5;28;01mtry[39;00m:

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/zarr/convenience.py:1360[0m, in [0;36mopen_consolidated[0;34m(store, metadata_key, mode, **kwargs)[0m
[1;32m   1357[0m         metadata_key [38;5;241m=[39m [38;5;124m"[39m[38;5;124mmeta/root/consolidated/[39m[38;5;124m"[39m [38;5;241m+[39m metadata_key
[1;32m   1359[0m [38;5;66;03m# setup metadata store[39;00m
[0;32m-> 1360[0m meta_store [38;5;241m=[39m [43mConsolidatedStoreClass[49m[43m([49m[43mstore[49m[43m,[49m[43m [49m[43mmetadata_key[49m[38;5;241;43m=[39;49m[43mmetadata_key[49m[43m)[49m
[1;32m   1362[0m [38;5;66;03m# pass through[39;00m
[1;32m   1363[0m chunk_store [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m"[39m[38;5;124mchunk_store[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m) [38;5;129;01mor[39;00m store

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/zarr/storage.py:3046[0m, in [0;36mConsolidatedMetadataStore.__init__[0;34m(self, store, metadata_key)[0m
[1;32m   3043[0m [38;5;28mself[39m[38;5;241m.[39mstore [38;5;241m=[39m Store[38;5;241m.[39m_ensure_store(store)
[1;32m   3045[0m [38;5;66;03m# retrieve consolidated metadata[39;00m
[0;32m-> 3046[0m meta [38;5;241m=[39m json_loads([38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mstore[49m[43m[[49m[43mmetadata_key[49m[43m][49m)
[1;32m   3048[0m [38;5;66;03m# check format of consolidated metadata[39;00m
[1;32m   3049[0m consolidated_format [38;5;241m=[39m meta[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mzarr_consolidated_format[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m)

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/zarr/storage.py:1446[0m, in [0;36mFSStore.__getitem__[0;34m(self, key)[0m
[1;32m   1444[0m key [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_normalize_key(key)
[1;32m   1445[0m [38;5;28;01mtry[39;00m:
[0;32m-> 1446[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmap[49m[43m[[49m[43mkey[49m[43m][49m
[1;32m   1447[0m [38;5;28;01mexcept[39;00m [38;5;28mself[39m[38;5;241m.[39mexceptions [38;5;28;01mas[39;00m e:
[1;32m   1448[0m     [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(key) [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01me[39;00m

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/mapping.py:155[0m, in [0;36mFSMap.__getitem__[0;34m(self, key, default)[0m
[1;32m    153[0m k [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_key_to_str(key)
[1;32m    154[0m [38;5;28;01mtry[39;00m:
[0;32m--> 155[0m     result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfs[49m[38;5;241;43m.[39;49m[43mcat[49m[43m([49m[43mk[49m[43m)[49m
[1;32m    156[0m [38;5;28;01mexcept[39;00m [38;5;28mself[39m[38;5;241m.[39mmissing_exceptions [38;5;28;01mas[39;00m exc:
[1;32m    157[0m     [38;5;28;01mif[39;00m default [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/asyn.py:118[0m, in [0;36msync_wrapper.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    115[0m [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)
[1;32m    116[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mwrapper[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    117[0m     [38;5;28mself[39m [38;5;241m=[39m obj [38;5;129;01mor[39;00m args[[38;5;241m0[39m]
[0;32m--> 118[0m     [38;5;28;01mreturn[39;00m [43msync[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mloop[49m[43m,[49m[43m [49m[43mfunc[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/asyn.py:103[0m, in [0;36msync[0;34m(loop, func, timeout, *args, **kwargs)[0m
[1;32m    101[0m     [38;5;28;01mraise[39;00m FSTimeoutError [38;5;28;01mfrom[39;00m[38;5;250m [39m[38;5;21;01mreturn_result[39;00m
[1;32m    102[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(return_result, [38;5;167;01mBaseException[39;00m):
[0;32m--> 103[0m     [38;5;28;01mraise[39;00m return_result
[1;32m    104[0m [38;5;28;01melse[39;00m:
[1;32m    105[0m     [38;5;28;01mreturn[39;00m return_result

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/asyn.py:56[0m, in [0;36m_runner[0;34m(event, coro, result, timeout)[0m
[1;32m     54[0m     coro [38;5;241m=[39m asyncio[38;5;241m.[39mwait_for(coro, timeout[38;5;241m=[39mtimeout)
[1;32m     55[0m [38;5;28;01mtry[39;00m:
[0;32m---> 56[0m     result[[38;5;241m0[39m] [38;5;241m=[39m [38;5;28;01mawait[39;00m coro
[1;32m     57[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m ex:
[1;32m     58[0m     result[[38;5;241m0[39m] [38;5;241m=[39m ex

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/asyn.py:477[0m, in [0;36mAsyncFileSystem._cat[0;34m(self, path, recursive, on_error, batch_size, **kwargs)[0m
[1;32m    475[0m     ex [38;5;241m=[39m [38;5;28mnext[39m([38;5;28mfilter[39m(is_exception, out), [38;5;28;01mFalse[39;00m)
[1;32m    476[0m     [38;5;28;01mif[39;00m ex:
[0;32m--> 477[0m         [38;5;28;01mraise[39;00m ex
[1;32m    478[0m [38;5;28;01mif[39;00m (
[1;32m    479[0m     [38;5;28mlen[39m(paths) [38;5;241m>[39m [38;5;241m1[39m
[1;32m    480[0m     [38;5;129;01mor[39;00m [38;5;28misinstance[39m(path, [38;5;28mlist[39m)
[1;32m    481[0m     [38;5;129;01mor[39;00m paths[[38;5;241m0[39m] [38;5;241m!=[39m [38;5;28mself[39m[38;5;241m.[39m_strip_protocol(path)
[1;32m    482[0m ):
[1;32m    483[0m     [38;5;28;01mreturn[39;00m {
[1;32m    484[0m         k: v
[1;32m    485[0m         [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m [38;5;28mzip[39m(paths, out)
[1;32m    486[0m         [38;5;28;01mif[39;00m on_error [38;5;241m!=[39m [38;5;124m"[39m[38;5;124momit[39m[38;5;124m"[39m [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m is_exception(v)
[1;32m    487[0m     }

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/fsspec/asyn.py:257[0m, in [0;36m_run_coros_in_chunks.<locals>._run_coro[0;34m(coro, i)[0m
[1;32m    255[0m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m_run_coro[39m(coro, i):
[1;32m    256[0m     [38;5;28;01mtry[39;00m:
[0;32m--> 257[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m asyncio[38;5;241m.[39mwait_for(coro, timeout[38;5;241m=[39mtimeout), i
[1;32m    258[0m     [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m e:
[1;32m    259[0m         [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m return_exceptions:

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/asyncio/tasks.py:408[0m, in [0;36mwait_for[0;34m(fut, timeout)[0m
[1;32m    405[0m loop [38;5;241m=[39m events[38;5;241m.[39mget_running_loop()
[1;32m    407[0m [38;5;28;01mif[39;00m timeout [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 408[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m fut
[1;32m    410[0m [38;5;28;01mif[39;00m timeout [38;5;241m<[39m[38;5;241m=[39m [38;5;241m0[39m:
[1;32m    411[0m     fut [38;5;241m=[39m ensure_future(fut, loop[38;5;241m=[39mloop)

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/gcsfs/core.py:1115[0m, in [0;36mGCSFileSystem._cat_file[0;34m(self, path, start, end, **kwargs)[0m
[1;32m   1113[0m [38;5;28;01melse[39;00m:
[1;32m   1114[0m     head [38;5;241m=[39m {}
[0;32m-> 1115[0m headers, out [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_call([38;5;124m"[39m[38;5;124mGET[39m[38;5;124m"[39m, u2, headers[38;5;241m=[39mhead)
[1;32m   1116[0m [38;5;28;01mreturn[39;00m out

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/gcsfs/core.py:481[0m, in [0;36mGCSFileSystem._call[0;34m(self, method, path, json_out, info_out, *args, **kwargs)[0m
[1;32m    477[0m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m_call[39m(
[1;32m    478[0m     [38;5;28mself[39m, method, path, [38;5;241m*[39margs, json_out[38;5;241m=[39m[38;5;28;01mFalse[39;00m, info_out[38;5;241m=[39m[38;5;28;01mFalse[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs
[1;32m    479[0m ):
[1;32m    480[0m     logger[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00mmethod[38;5;241m.[39mupper()[38;5;132;01m}[39;00m[38;5;124m: [39m[38;5;132;01m{[39;00mpath[38;5;132;01m}[39;00m[38;5;124m, [39m[38;5;132;01m{[39;00margs[38;5;132;01m}[39;00m[38;5;124m, [39m[38;5;132;01m{[39;00mkwargs[38;5;241m.[39mget([38;5;124m'[39m[38;5;124mheaders[39m[38;5;124m'[39m)[38;5;132;01m}[39;00m[38;5;124m"[39m)
[0;32m--> 481[0m     status, headers, info, contents [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_request(
[1;32m    482[0m         method, path, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs
[1;32m    483[0m     )
[1;32m    484[0m     [38;5;28;01mif[39;00m json_out:
[1;32m    485[0m         [38;5;28;01mreturn[39;00m json[38;5;241m.[39mloads(contents)

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/decorator.py:224[0m, in [0;36mdecorate.<locals>.fun[0;34m(*args, **kw)[0m
[1;32m    222[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m kwsyntax:
[1;32m    223[0m     args, kw [38;5;241m=[39m fix(args, kw, sig)
[0;32m--> 224[0m [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m caller(func, [38;5;241m*[39m(extras [38;5;241m+[39m args), [38;5;241m*[39m[38;5;241m*[39mkw)

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/gcsfs/retry.py:135[0m, in [0;36mretry_request[0;34m(func, retries, *args, **kwargs)[0m
[1;32m    133[0m     [38;5;28;01mif[39;00m retry [38;5;241m>[39m [38;5;241m0[39m:
[1;32m    134[0m         [38;5;28;01mawait[39;00m asyncio[38;5;241m.[39msleep([38;5;28mmin[39m(random[38;5;241m.[39mrandom() [38;5;241m+[39m [38;5;241m2[39m [38;5;241m*[39m[38;5;241m*[39m (retry [38;5;241m-[39m [38;5;241m1[39m), [38;5;241m32[39m))
[0;32m--> 135[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m func([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m    136[0m [38;5;28;01mexcept[39;00m (
[1;32m    137[0m     HttpError,
[1;32m    138[0m     requests[38;5;241m.[39mexceptions[38;5;241m.[39mRequestException,
[0;32m   (...)[0m
[1;32m    141[0m     aiohttp[38;5;241m.[39mclient_exceptions[38;5;241m.[39mClientError,
[1;32m    142[0m ) [38;5;28;01mas[39;00m e:
[1;32m    143[0m     [38;5;28;01mif[39;00m (
[1;32m    144[0m         [38;5;28misinstance[39m(e, HttpError)
[1;32m    145[0m         [38;5;129;01mand[39;00m e[38;5;241m.[39mcode [38;5;241m==[39m [38;5;241m400[39m
[1;32m    146[0m         [38;5;129;01mand[39;00m [38;5;124m"[39m[38;5;124mrequester pays[39m[38;5;124m"[39m [38;5;129;01min[39;00m e[38;5;241m.[39mmessage
[1;32m    147[0m     ):

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/gcsfs/core.py:474[0m, in [0;36mGCSFileSystem._request[0;34m(self, method, path, headers, json, data, *args, **kwargs)[0m
[1;32m    471[0m info [38;5;241m=[39m r[38;5;241m.[39mrequest_info  [38;5;66;03m# for debug only[39;00m
[1;32m    472[0m contents [38;5;241m=[39m [38;5;28;01mawait[39;00m r[38;5;241m.[39mread()
[0;32m--> 474[0m [43mvalidate_response[49m[43m([49m[43mstatus[49m[43m,[49m[43m [49m[43mcontents[49m[43m,[49m[43m [49m[43mpath[49m[43m,[49m[43m [49m[43margs[49m[43m)[49m
[1;32m    475[0m [38;5;28;01mreturn[39;00m status, headers, info, contents

File [0;32m~/miniconda3/envs/xbatcher-ML-1-cookbook-dev/lib/python3.10/site-packages/gcsfs/retry.py:120[0m, in [0;36mvalidate_response[0;34m(status, content, path, args)[0m
[1;32m    118[0m     [38;5;28;01mraise[39;00m requests[38;5;241m.[39mexceptions[38;5;241m.[39mProxyError()
[1;32m    119[0m [38;5;28;01melif[39;00m [38;5;124m"[39m[38;5;124minvalid[39m[38;5;124m"[39m [38;5;129;01min[39;00m [38;5;28mstr[39m(msg):
[0;32m--> 120[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mBad Request: [39m[38;5;132;01m{[39;00mpath[38;5;132;01m}[39;00m[38;5;130;01m\n[39;00m[38;5;132;01m{[39;00mmsg[38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m    121[0m [38;5;28;01melif[39;00m error [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(error, [38;5;28mstr[39m):
[1;32m    122[0m     [38;5;28;01mraise[39;00m HttpError(error)

[0;31mValueError[0m: Bad Request: https://storage.googleapis.com/download/storage/v1/b/pangeo-cesm-pop/o/control%2F.zmetadata?alt=media
User project specified in the request is invalid.

